---------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\m.callaghan\Documents\GitHub\panel_methods_slides\stata_guide\stata\logs/import_loop.log
  log type:  text
 opened on:  25 Jan 2016, 19:35:21

. *@*lstart
. local sheets `" "Fear of Crime-Borough" "MOPAC Priority-Borough" "Officer Strength-Borough" "Sergeant Strength-Borough" "Special Strength-Borough" "PCSO Stre
> ngth-Borough" "Staff Strength-Borough" "'  

. local cranges A3:AG31 A3:AH58 A5:AG97 A4:AG36 A5:AG97 A5:AG97 A5:AG97

. local varnames FoC MOPAC OffStrength SgtStrength SpclStrength PCSOStrength StaffStrength

. local N : word count `sheets'

. 
. forvalues i = 1/`N' {
  2.         local sheet : word `i' of `sheets'
  3.         local crange : word `i' of `cranges'
  4.         local varname : word `i' of `varnames'
  5.         clear   
  6.         import excel data/crime.xls, ///
>                 sheet("`sheet'") ///
>                 cellrange("`crange'") ///
>                 firstrow        
  7.         cap rename (BarkingandDagenham HammersmithandFulham KensingtonandChelsea) ///
>       (BarkingDagenham HammersmithFulham KensingtonChelsea) // Inconsistent names
  8.         cap drop HeathrowAirport
  9.         cap rename A MonthYear // Merged cell caused problem    
 10.         sort MonthYear
 11.         by MonthYear: gen dup = cond(_N==1,0,_n)
 12.         drop if dup > 0
 13.         drop dup
 14.         rename (BarkingDagenham-Westminster) `varname'=
 15.         reshape long "`varname'", i(MonthYear) j(Borough) string
 16.         save data/`varname'.dta, replace
 17. }
(2 observations deleted)
(note: j = BarkingDagenham Barnet Bexley Brent Bromley Camden Croydon Ealing Enfield Greenwich Hackney HammersmithFulham Haringey Harrow Havering Hillingdon Ho
> unslow Islington KensingtonChelsea KingstonuponThames Lambeth Lewisham Merton Newham Redbridge RichmonduponThames Southwark Sutton TowerHamlets WalthamForest
>  Wandsworth Westminster)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                       26   ->     832
Number of variables                  33   ->       3
j variable (32 values)                    ->   Borough
xij variables:
FoCBarkingDagenham FoCBarnet ... FoCWestminster->FoC
-----------------------------------------------------------------------------
file data/FoC.dta saved
(0 observations deleted)
(note: j = BarkingDagenham Barnet Bexley Brent Bromley Camden Croydon Ealing Enfield Greenwich Hackney HammersmithFulham Haringey Harrow Havering Hillingdon Ho
> unslow Islington KensingtonChelsea KingstonuponThames Lambeth Lewisham Merton Newham Redbridge RichmonduponThames Southwark Sutton TowerHamlets WalthamForest
>  Wandsworth Westminster)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                       55   ->    1760
Number of variables                  33   ->       3
j variable (32 values)                    ->   Borough
xij variables:
MOPACBarkingDagenham MOPACBarnet ... MOPACWestminster->MOPAC
-----------------------------------------------------------------------------
file data/MOPAC.dta saved
(0 observations deleted)
(note: j = BarkingDagenham Barnet Bexley Brent Bromley Camden Croydon Ealing Enfield Greenwich Hackney HammersmithFulham Haringey Harrow Havering Hillingdon Ho
> unslow Islington KensingtonChelsea KingstonuponThames Lambeth Lewisham Merton Newham Redbridge RichmonduponThames Southwark Sutton TowerHamlets WalthamForest
>  Wandsworth Westminster)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                       92   ->    2944
Number of variables                  33   ->       3
j variable (32 values)                    ->   Borough
xij variables:
OffStrengthBarkingDagenham OffStrengthBarnet ... OffStrengthWestminster->OffStrength
-----------------------------------------------------------------------------
file data/OffStrength.dta saved
(0 observations deleted)
(note: j = BarkingDagenham Barnet Bexley Brent Bromley Camden Croydon Ealing Enfield Greenwich Hackney HammersmithFulham Haringey Harrow Havering Hillingdon Ho
> unslow Islington KensingtonChelsea KingstonuponThames Lambeth Lewisham Merton Newham Redbridge RichmonduponThames Southwark Sutton TowerHamlets WalthamForest
>  Wandsworth Westminster)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                       32   ->    1024
Number of variables                  33   ->       3
j variable (32 values)                    ->   Borough
xij variables:
SgtStrengthBarkingDagenham SgtStrengthBarnet ... SgtStrengthWestminster->SgtStrength
-----------------------------------------------------------------------------
file data/SgtStrength.dta saved
(0 observations deleted)
(note: j = BarkingDagenham Barnet Bexley Brent Bromley Camden Croydon Ealing Enfield Greenwich Hackney HammersmithFulham Haringey Harrow Havering Hillingdon Ho
> unslow Islington KensingtonChelsea KingstonuponThames Lambeth Lewisham Merton Newham Redbridge RichmonduponThames Southwark Sutton TowerHamlets WalthamForest
>  Wandsworth Westminster)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                       92   ->    2944
Number of variables                  33   ->       3
j variable (32 values)                    ->   Borough
xij variables:
SpclStrengthBarkingDagenham SpclStrengthBarnet ... SpclStrengthWestminster->SpclStrength
-----------------------------------------------------------------------------
file data/SpclStrength.dta saved
(0 observations deleted)
(note: j = BarkingDagenham Barnet Bexley Brent Bromley Camden Croydon Ealing Enfield Greenwich Hackney HammersmithFulham Haringey Harrow Havering Hillingdon Ho
> unslow Islington KensingtonChelsea KingstonuponThames Lambeth Lewisham Merton Newham Redbridge RichmonduponThames Southwark Sutton TowerHamlets WalthamForest
>  Wandsworth Westminster)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                       92   ->    2944
Number of variables                  33   ->       3
j variable (32 values)                    ->   Borough
xij variables:
PCSOStrengthBarkingDagenham PCSOStrengthBarnet ... PCSOStrengthWestminster->PCSOStrength
-----------------------------------------------------------------------------
file data/PCSOStrength.dta saved
(0 observations deleted)
(note: j = BarkingDagenham Barnet Bexley Brent Bromley Camden Croydon Ealing Enfield Greenwich Hackney HammersmithFulham Haringey Harrow Havering Hillingdon Ho
> unslow Islington KensingtonChelsea KingstonuponThames Lambeth Lewisham Merton Newham Redbridge RichmonduponThames Southwark Sutton TowerHamlets WalthamForest
>  Wandsworth Westminster)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                       92   ->    2944
Number of variables                  33   ->       3
j variable (32 values)                    ->   Borough
xij variables:
StaffStrengthBarkingDagenham StaffStrengthBarnet ... StaffStrengthWestminster->StaffStrength
-----------------------------------------------------------------------------
file data/StaffStrength.dta saved

. *@*lend
. cap log close
